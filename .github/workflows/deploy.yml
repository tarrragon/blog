å¤ªå¥½äº† ğŸ‘ ä½ é€™å€‹ workflow å¹¾ä¹å®Œæ•´ï¼Œä½†å·®åœ¨æœ€å¾Œä¸€æ­¥çš„ éƒ¨ç½²æ–¹å¼ã€‚

ğŸ‘‰ ä½ ç¾åœ¨æ˜¯ç”¨ peaceiris/actions-gh-pages@v3ï¼Œå®ƒæœƒå¹«ä½ æŠŠå…§å®¹æ¨åˆ°ä¸€å€‹ gh-pages branchã€‚
é€™æ²’éŒ¯ï¼Œä½† GitHub Pages çš„æ–°ç‰ˆï¼ˆ2022ä¹‹å¾Œï¼‰æ¨è–¦ç”¨ actions/deploy-pagesï¼Œè€Œä¸”é€™æ¨£ Settings â†’ Pages é é¢æ‰æœƒè‡ªå‹•é¡¯ç¤ºç¶²å€ã€‚


---

æˆ‘å¹«ä½ æ¨™å‡º ç›®å‰å°‘çš„éƒ¨åˆ† å’Œ æ”¹é€²å»ºè­°ï¼ˆé™„è¨»è§£ï¼‰ï¼š

name: Deploy Hugo site to Pages

on:
  push:
    branches:
      - main   # åªè¦æ¨åˆ° main å°±æœƒè§¸ç™¼éƒ¨ç½²

permissions:
  contents: read   # âœ… åªéœ€è¦ readï¼Œå› ç‚º deploy-pages æœƒè² è²¬æ¨ branch
  pages: write     # âœ… å¿…è¦ï¼Œæ‰èƒ½å¯«å…¥ GitHub Pages
  id-token: write  # âœ… å¿…è¦ï¼Œæ‰èƒ½ä½¿ç”¨ OIDC èº«ä»½é©—è­‰

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      # 1. æŠŠ repo checkout ä¸‹ä¾†
      - name: Checkout
        uses: actions/checkout@v3

      # 2. å®‰è£ Hugo
      - name: Setup Hugo
        uses: peaceiris/actions-hugo@v2
        with:
          hugo-version: '0.148.2'   # æ›æˆä½ è¦ç”¨çš„ Hugo ç‰ˆæœ¬
          extended: true            # å»ºè­°é–‹å•Ÿ (æ”¯æ´ SCSS)

      # 3. ç·¨è­¯ç¶²ç«™
      - name: Build
        run: hugo --minify

      # 4. ä¸Šå‚³ç·¨è­¯å¥½çš„æª”æ¡ˆï¼Œçµ¦ deploy job ç”¨
      - name: Upload artifact   
        uses: actions/upload-pages-artifact@v2
        with:
          path: ./public         # Hugo é è¨­è¼¸å‡ºè³‡æ–™å¤¾

  deploy:
    needs: build                 # â¬…ï¸ å…ˆè·‘å®Œ build æ‰èƒ½ deploy
    runs-on: ubuntu-latest
    environment:
      name: github-pages         # â¬…ï¸ GitHub æœƒè‡ªå‹•ç¶å®š Pages
      url: ${{ steps.deployment.outputs.page_url }}  # è‡ªå‹•ç”Ÿæˆç¶²å€
    steps:
      - name: Deploy to GitHub Pages
        id: deployment
        uses: actions/deploy-pages@v2   # â¬…ï¸ å®˜æ–¹å»ºè­°ç”¨é€™å€‹ä¾†å–ä»£ peaceiris

